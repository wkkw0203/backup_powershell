$data = Get-Date -Format "dd_MM_yy"

Add-Type -AssemblyName System.Windows.Forms
$browser = New-Object System.Windows.Forms.FolderBrowserDialog
$null = $browser.ShowDialog()
$sciezka = $browser.SelectedPath


if( Test-Path -path "$HOME\backups\$data\")
{
 Set-Location "$HOME\backups\$data\"
$files= (Get-ChildItem | Measure-Object).Count +1
}
Set-Location $sciezka
Copy-Item -Path $sciezka -Destination "$HOME\backups\$data\backup_$files" -Recurse -force

#$background = Get-Childitem –Path "$HOME" -Include bcgimagepowershellapp.jpg  -Recurse -Depth 4 | ForEach-Object{$_.FullName} 
#$icon1 = Get-Childitem –Path "$HOME" -Include ikonapowershellapp.ico  -Recurse -Depth 4 | ForEach-Object{$_.FullName} 
#STARTING GUI CODE
Add-Type -assembly System.Windows.Forms
$main_form = New-Object System.Windows.Forms.Form
$main_form.Text ="`n `n  saved as: $data/ backup_/ $files"
$main_form.Width = 600
$main_form.Height = 400
$main_form.AutoSize = $true
$main_form.TopMost = $true
#icon as base64 
$iconBase64      = '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'
$iconBytes       = [Convert]::FromBase64String($iconBase64)
# initialize a Memory stream holding the bytes
$stream          = [System.IO.MemoryStream]::new($iconBytes, 0, $iconBytes.Length)
$main_form.Icon       = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($stream).GetHIcon()))

$main_form.BackgroundImage = $objImage
$main_form.BackgroundImageLayout = "None"


$Label = New-Object System.Windows.Forms.Label
$Label.Text = "`n `n  saved as: $data/ backup_/ $files"
$Label.Location  = New-Object System.Drawing.Point(0,50)
$Label.AutoSize = $true
$main_form.Controls.Add($Label)

$main_form.ShowDialog()


#ENDING GUI CODE

